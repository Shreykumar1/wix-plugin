import{$ as c}from"./chunk-RVHPVWYH-DIandYsq.js";function u(){let n=null,t=null;return{promise:new Promise((e,o)=>{n=e,t=o}),resolve:n,reject:t}}var d=n=>{let{createHost:t}=n;return{__type:"host",create:e=>({}),host:e=>{var o,r;let i=t(e),a=w();return{...i,apiBaseUrl:a,essentials:{language:(o=window)==null||(o=o.commonConfig)==null?void 0:o.language,locale:(r=window)==null||(r=r.commonConfig)==null?void 0:r.locale}}},auth:e=>{let o=typeof window<"u"?window.wixEmbedsAPI:void 0;e||(e=o==null||o.getAccessTokenFunction==null?void 0:o.getAccessTokenFunction());let r=!1,{resolve:i,promise:a}=u();return{getAuthHeaders:async()=>{if(!e&&r&&(e=await a),!e)throw new Error("Failed to resolve auth token");return{headers:{Authorization:await e()}}},getAccessTokenInjector:()=>(r=!0,s=>{i(s)})}}}};function w(){let n=typeof window<"u"?window.wixEmbedsAPI:void 0,t=n==null||n.getExternalBaseUrl==null?void 0:n.getExternalBaseUrl();if(!t)return;let e=new URL(t);return e!=null&&e.pathname&&e.pathname!=="/"?""+e.hostname+e.pathname:e.hostname}var p=n=>{let{clientSdk:t,applicationId:e}=n;return{invoke:async o=>{let{namespace:r,method:i,args:a}=o;if(!t)throw new Error("Wix Site SDK only works in a Wix site environment. Learn more: https://dev.wix.com/docs/sdk/host-modules/site/introduction");return t.invoke({namespace:r,method:i,args:a,applicationId:e,accessToken:"accessToken"})},getAccessToken:()=>{throw new Error("Not implemented")},observeState:()=>({disconnect:()=>{}})}},m=function(n){let t=typeof $wixContext<"u"&&$wixContext.clientSdk||(n==null?void 0:n.clientSdk)||window.clientSdk,{applicationId:e}=n||{};if(!e)throw new Error('"createHost" was called without a required field "applicationId"');return{channel:p({clientSdk:t,applicationId:e}),close:()=>{}}},l=d({createHost:m}),h=n=>{let t=l.host({applicationId:n}),e=l.auth(),o=e.getAccessTokenInjector();return c({auth:e,host:t}).enableContext("module"),{injectGetAccessToken:o}};const{injectGetAccessToken:k}=h("89a138ec-fb50-41d6-a688-181213ef0b7a"),f=n=>{k(n)};export{f as injectAccessTokenFunction};
//# sourceMappingURL=_virtual_wix-context-module-DM31AnAF.js.map
